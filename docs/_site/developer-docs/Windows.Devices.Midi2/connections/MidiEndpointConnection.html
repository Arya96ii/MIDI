<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(2)) > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(2) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/docs/assets/js/vendor/lunr.min.js"></script> <script src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>MidiEndpointConnection | Windows MIDI Services</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="MidiEndpointConnection" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="User and developer documentation for the Windows MIDI Services project" /> <meta property="og:description" content="User and developer documentation for the Windows MIDI Services project" /> <link rel="canonical" href="http://localhost:4000/docs/developer-docs/Windows.Devices.Midi2/connections/MidiEndpointConnection.html" /> <meta property="og:url" content="http://localhost:4000/docs/developer-docs/Windows.Devices.Midi2/connections/MidiEndpointConnection.html" /> <meta property="og:site_name" content="Windows MIDI Services" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="MidiEndpointConnection" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"User and developer documentation for the Windows MIDI Services project","headline":"MidiEndpointConnection","url":"http://localhost:4000/docs/developer-docs/Windows.Devices.Midi2/connections/MidiEndpointConnection.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/docs/" class="site-title lh-tight"> Windows MIDI Services </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Windows Midi Services category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/" class="nav-list-link">Windows Midi Services</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/api-back-compat.html" class="nav-list-link">API Backwards Compatibility</a></li><li class="nav-list-item"><a href="/docs/developer-docs/best-practices.html" class="nav-list-link">Best Practices</a></li><li class="nav-list-item"><a href="/docs/config-json.html" class="nav-list-link">Config JSON</a></li><li class="nav-list-item"><a href="/docs/developer-docs/consuming-midi-api.html" class="nav-list-link">Consuming the MIDI API</a></li><li class="nav-list-item"><a href="/docs/developer-docs/diagnostic-endpoints.html" class="nav-list-link">Diagnostics Endpoints</a></li><li class="nav-list-item"><a href="/docs/developer-docs/endpoint-ids.html" class="nav-list-link">Endpoint Device Ids</a></li><li class="nav-list-item"><a href="/docs/midi-console.html" class="nav-list-link">MIDI Console</a></li><li class="nav-list-item"><a href="/docs/developer-docs/faq-programming-languages.html" class="nav-list-link">Programming Languages FAQ</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Windows.Devices.Midi2 API category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/README.html" class="nav-list-link">Windows.Devices.Midi2 API</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Client Plugins category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/processing-plugins/README.html" class="nav-list-link">Client Plugins</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/processing-plugins/IMidiEndpointMessageProcessingPlugin.html" class="nav-list-link">IMidiEndpointMessageProcessingPlugin</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/processing-plugins/MidiChannelEndpointListener.html" class="nav-list-link">MidiChannelEndpointListener</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/processing-plugins/MidiGroupEndpointListener.html" class="nav-list-link">MidiGroupEndpointListener</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/processing-plugins/MidiMessageTypeEndpointListener.html" class="nav-list-link">MidiMessageTypeEndpointListener</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Connections category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/connections/README.html" class="nav-list-link">Connections</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/connections/IMidiEndpointConnectionSettings.html" class="nav-list-link">IMidiEndpointConnectionSettings</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/connections/MidiEndpointConnection.html" class="nav-list-link">MidiEndpointConnection</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/connections/MidiMessageReceivedEventArgs.html" class="nav-list-link">MidiMessageReceivedEventArgs</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Endpoint Enumeration category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/enumeration/README.html" class="nav-list-link">Endpoint Enumeration</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/enumeration/MidiEndpointDeviceInformation.html" class="nav-list-link">MidiEndpointDeviceInformation</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/enumeration/MidiEndpointDeviceInformationUpdateEventArgs.html" class="nav-list-link">MidiEndpointDeviceInformationUpdateEventArgs</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/enumeration/MidiEndpointDeviceWatcher.html" class="nav-list-link">MidiEndpointDeviceWatcher</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Message Utilities category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/README.html" class="nav-list-link">Message Utilities</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/MidiMessageBuilder.html" class="nav-list-link">MidiMessageBuilder</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/MidiMessageConverter.html" class="nav-list-link">MidiMessageConverter</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/MidiMessageTranslator.html" class="nav-list-link">MidiMessageTranslator</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/MidiMessageUtility.html" class="nav-list-link">MidiMessageUtility</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/message-utilities/MidiStreamMessageBuilder.html" class="nav-list-link">MidiStreamMessageBuilder</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Messages category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/messages/README.html" class="nav-list-link">Messages</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/IMidiUniversalPacket.html" class="nav-list-link">IMidiUniversalPacket</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessage128.html" class="nav-list-link">MidiMessage128</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessage32.html" class="nav-list-link">MidiMessage32</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessage64.html" class="nav-list-link">MidiMessage64</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessage96.html" class="nav-list-link">MidiMessage96</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessageStruct.html" class="nav-list-link">MidiMessageStruct</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiMessageTypeEnum.html" class="nav-list-link">MidiMessageType</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/messages/MidiPacketTypeEnum.html" class="nav-list-link">MidiPacketType</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Metadata category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/metadata/README.html" class="nav-list-link">Metadata</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/metadata/MidiFunctionBlock.html" class="nav-list-link">MidiFunctionBlock</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/metadata/MidiGroupTerminalBlock.html" class="nav-list-link">MidiGroupTerminalBlock</a> </li></ul></li><li class="nav-list-item"><a href="/docs/developer-docs/Windows.Devices.Midi2/clock/MidiClock.html" class="nav-list-link">MidiClock</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Service category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/service/README.html" class="nav-list-link">Service</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiService.html" class="nav-list-link">MidiService</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiServiceMessageProcessingPluginInformation.html" class="nav-list-link">MidiServiceMessageProcessingPluginInformation</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiServicePingResponse.html" class="nav-list-link">MidiServicePingResponse</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiServicePingResponseSummary.html" class="nav-list-link">MidiServicePingResponseSummary</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiServiceTransportPluginInformation.html" class="nav-list-link">MidiServiceTransportPluginInformation</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiSessionConnectionInformation.html" class="nav-list-link">MidiSessionConnectionInformation</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/service/MidiSessionInformation.html" class="nav-list-link">MidiSessionInformation</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Session category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/session/README.html" class="nav-list-link">Session</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/session/MidiSession.html" class="nav-list-link">MidiSession</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/session/MidiSessionSettings.html" class="nav-list-link">MidiSessionSettings</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Simple Types category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/simple-types/README.html" class="nav-list-link">Simple Types</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/simple-types/MidiChannel.html" class="nav-list-link">MidiChannel</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/simple-types/MidiGroup.html" class="nav-list-link">MidiGroup</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/simple-types/MidiUniqueId.html" class="nav-list-link">MidiUniqueId</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Virtual Devices category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/developer-docs/Windows.Devices.Midi2/virtual-device/README.html" class="nav-list-link">Virtual Devices</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/virtual-device/MidiStreamConfigurationRequestReceivedEventArgs.html" class="nav-list-link">MidiStreamConfigurationRequestReceivedEventArgs</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/virtual-device/MidiVirtualEndpointDevice.html" class="nav-list-link">MidiVirtualEndpointDevice</a> </li><li class="nav-list-item"> <a href="/docs/developer-docs/Windows.Devices.Midi2/virtual-device/MidiVirtualEndpointDeviceDefinition.html" class="nav-list-link">MidiVirtualEndpointDeviceDefinition</a> </li></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Windows MIDI Services" aria-label="Search Windows MIDI Services" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/developer-docs/Windows.Devices.Midi2/README.html">Windows.Devices.Midi2 API</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/developer-docs/Windows.Devices.Midi2/connections/README.html">Connections</a></li> <li class="breadcrumb-nav-list-item"><span>MidiEndpointConnection</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="midiendpointconnection"> <a href="#midiendpointconnection" class="anchor-heading" aria-labelledby="midiendpointconnection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MidiEndpointConnection </h1> <p>The <code class="language-plaintext highlighter-rouge">MidiEndpointConnection</code> type represents a single connection to a single endpoint managed by Windows MIDI Services. It is created using the functions of the <code class="language-plaintext highlighter-rouge">MidiSession</code>, and is tied to the lifetime of that session.</p> <p>Connections allocate resources including send/receive buffers, and processing threads. For that reason, a session should generally not open more than one connection to a single endpoint. If you need to partition out messages more easily (by group or channel, for example) the <code class="language-plaintext highlighter-rouge">MessageProcessingPlugins</code> collection will help you do that.</p> <p>To ensure an application is able to wire up processing plugins and event handlers before the connection is active, the connection returned by the <code class="language-plaintext highlighter-rouge">MidiSession</code> is not yet open. Once the connection is acquired, the application should assign event handlers, and optionally assign any message processing plugins. Once complete, the application calls the <code class="language-plaintext highlighter-rouge">Open()</code> function to connect to the service, create the queues, and begin sending and receiving messages.</p> <h2 id="a-note-on-sending-messages"> <a href="#a-note-on-sending-messages" class="anchor-heading" aria-labelledby="a-note-on-sending-messages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A note on sending messages </h2> <p>All <code class="language-plaintext highlighter-rouge">SendMessageXX</code> functions send a single Universal MIDI Packet message at a time. The pluralized versions <code class="language-plaintext highlighter-rouge">SendMessagesXX</code> will send multiple packets, in order, with the same timestamp.</p> <p>Currently, in the implementation behind the scenes, the service receives each timestamped message one at a time. We have the functions for sending more than one message as a developer convenience for similarity with other platforms, and also to allow for possible future optimization in the service communication code.</p> <h2 id="properties"> <a href="#properties" class="anchor-heading" aria-labelledby="properties"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Properties </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Property</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">ConnectionId</code></td> <td>The generated GUID which uniquely identifes this connection instance. This is what is provided to the <code class="language-plaintext highlighter-rouge">MidiSession</code> when disconnecting an endpoint</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">EndpointDeviceId</code></td> <td>The system-wide identifier for the device connection. This is returned through enumeration calls.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Tag</code></td> <td>You may use this <code class="language-plaintext highlighter-rouge">Tag</code> property to hold any additional information you wish to have associated with the connection.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">IsOpen</code></td> <td>True if this connection is currently open. When first created, the connection is not open until the consuming code calls the <code class="language-plaintext highlighter-rouge">Open</code> method</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Settings</code></td> <td>Settings used to create this connection. Treat this as read-only.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">MessageProcessingPlugins</code></td> <td>Collection of all message processing plugins which will optionally handle incoming messages.</td> </tr> </tbody> </table></div> <h2 id="static-member-functions"> <a href="#static-member-functions" class="anchor-heading" aria-labelledby="static-member-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Static Member Functions </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Static Function</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">GetDeviceSelector()</code></td> <td>Returns the device selector used for enumerating endpoint devices compatible with this API.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageSucceeded(sendResult)</code></td> <td>Helper function to decipher the return result of a message sending function to tell if it succeeded.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageFailed(sendResult)</code></td> <td>Helper function to decipher the return result of a message sending function to tell if it failed.</td> </tr> </tbody> </table></div> <h2 id="functions"> <a href="#functions" class="anchor-heading" aria-labelledby="functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Functions </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Function</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">Open()</code></td> <td>Open the connection and start receiving messages. Wire up the message event handler before calling this method.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessagePacket(message)</code></td> <td>Send an <code class="language-plaintext highlighter-rouge">IMidiUniversalPacket</code>-implementing type such as <code class="language-plaintext highlighter-rouge">MidiMessage64</code> or a strongly-typed message class.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageStruct(timestamp, message, wordCount)</code></td> <td>Send a fixed-sized <code class="language-plaintext highlighter-rouge">MidiMessageStruct</code> containing <code class="language-plaintext highlighter-rouge">wordCount</code> valid words. Additional words are ignored.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageWordArray(timestamp, words, startIndex, wordCount)</code></td> <td>Note: Some projections will send the entire array as a copy, so this may not be the most effecient way to send messages from your language.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageWords(timestamp, word0)</code></td> <td>Send a single 32-bit Universal MIDI Packet as 32-bit words. This is often the most efficient way to send this type of message</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageWords(timestamp, word0, word1)</code></td> <td>Send a single 64-bit Universal MIDI Packet as 32-bit words. This is often the most efficient way to send this type of message</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageWords(timestamp, word0, word1, word2)</code></td> <td>Send a single 96-bit Universal MIDI Packet as 32-bit words. This is often the most efficient way to send this type of message</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageWords(timestamp, word0, word1, word2, word3)</code></td> <td>Send a single 128-bit Universal MIDI Packet as 32-bit words. This is often the most efficient way to send this type of message</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessageBuffer(timestamp, buffer, byteOffset, byteLength)</code></td> <td>Send a single Universal MIDI Packet as bytes from a buffer. The number of bytes sent must match the size read from the first 4 bits of the data starting at the specified offset, and must be laid out correctly with the first byte corresponding to the MSB of the first word of the UMP (the word which contains hte message type). If you want to manage a chunk of buffer memory, the <code class="language-plaintext highlighter-rouge">IMemoryBuffer</code> type is the acceptable WinRT approach, and is as close as you get to sending a pointer into a buffer.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessagesWordList(timestamp,words)</code></td> <td>This sends more than one message with the same timestamp. Message words must be ordered contiguously from word-0 to word-n for each message, and the message types must be valid for the number of words for each message. If an error is encountered when sending messages, the function stops processing the list at that point and returns a failure code, even if some messages were sent successfully.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SendMessagesWordArray(timestamp,words)</code></td> <td>This sends more than one message with the same timestamp. Message words must be ordered contiguously from word-0 to word-n for each message, and the message types must be valid for the number of words for each message. If an error is encountered when sending messages, the function stops processing the list at that point and returns a failure code, even if some messages were sent successfully.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">AddEndpointProcessingPlugin(plugin)</code></td> <td>Add an endpoint processing plugin to this connection</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">RemoveEndpointProcessingPlugin(id)</code></td> <td>Remove an endpoint processing plugin from this connection</td> </tr> </tbody> </table></div> <blockquote> <p>Tip: In all the functions which accept a timestamp to schedule the message, <strong>you can send a timestamp of 0 (zero) to bypass the scheduler and send the message immediately</strong>. Otherwise, the provided timestamp is treated as an absolute time for when the message should be sent from the service. Note that the service-based scheduler (currently based on a <code class="language-plaintext highlighter-rouge">std::priority_queue</code>) gets less efficient when there are thousands of messages in it, so it’s recommended that you not schedule too many messages at a time or too far out into the future.</p> </blockquote> <h2 id="events"> <a href="#events" class="anchor-heading" aria-labelledby="events"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Events </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Event</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">MessageReceived(source, args)</code></td> <td>From <code class="language-plaintext highlighter-rouge">IMidiMessageReceivedEventSource</code>. This is the event for receiving MIDI Messages, one at a time.</td> </tr> </tbody> </table></div> <p>When processing the <code class="language-plaintext highlighter-rouge">MessageReceived</code> event, do so quickly. This event is synchronous. If you need to do long-running processing of incoming messages, add them to your own incoming queue structure and have them processed by another application thread.</p> <blockquote> <p>Note: Wire up event handlers and add message processing plugins prior to calling <code class="language-plaintext highlighter-rouge">Open()</code>.</p> </blockquote> <h2 id="idl"> <a href="#idl" class="anchor-heading" aria-labelledby="idl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IDL </h2> <p><a href="https://github.com/microsoft/MIDI/blob/main/src/api/Client/Midi2Client/MidiEndpointConnection.idl">MidiEndpointConnection IDL</a></p> <h2 id="sample"> <a href="#sample" class="anchor-heading" aria-labelledby="sample"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sample </h2> <p>Here’s an excerpt from the full “API client basics” sample. It shows sending and receiving messages using the two built-in loopback endpoints. For more information on the loopback endpoints, see <a href="../../../diagnostic-endpoints.md">diagnostics endpoints</a>.</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">session</span> <span class="p">=</span> <span class="n">MidiSession</span><span class="p">.</span><span class="nf">CreateSession</span><span class="p">(</span><span class="s">"API Sample Session"</span><span class="p">))</span>
<span class="p">{</span>
    <span class="c1">// get the endpoint Ids. Normally, you'd use enumeration functions to get this</span>
    <span class="c1">// for non-diagnostics endpoints.</span>
    <span class="kt">var</span> <span class="n">endpointAId</span> <span class="p">=</span> <span class="n">MidiEndpointDeviceInformation</span><span class="p">.</span><span class="n">DiagnosticsLoopbackAEndpointId</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">endpointBId</span> <span class="p">=</span> <span class="n">MidiEndpointDeviceInformation</span><span class="p">.</span><span class="n">DiagnosticsLoopbackBEndpointId</span><span class="p">;</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Connecting to Sender UMP Endpoint: "</span> <span class="p">+</span> <span class="n">endpointAId</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Connecting to Receiver UMP Endpoint: "</span> <span class="p">+</span> <span class="n">endpointBId</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">sendEndpoint</span> <span class="p">=</span> <span class="n">session</span><span class="p">.</span><span class="nf">CreateEndpointConnection</span><span class="p">(</span><span class="n">endpointAId</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">receiveEndpoint</span> <span class="p">=</span> <span class="n">session</span><span class="p">.</span><span class="nf">CreateEndpointConnection</span><span class="p">(</span><span class="n">endpointBId</span><span class="p">);</span>

    <span class="k">void</span> <span class="nf">MessageReceivedHandler</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">MidiMessageReceivedEventArgs</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">ump</span> <span class="p">=</span> <span class="n">args</span><span class="p">.</span><span class="nf">GetMessagePacket</span><span class="p">();</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Received UMP"</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- Current Timestamp: "</span> <span class="p">+</span> <span class="n">MidiClock</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- UMP Timestamp:     "</span> <span class="p">+</span> <span class="n">ump</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- UMP Msg Type:      "</span> <span class="p">+</span> <span class="n">ump</span><span class="p">.</span><span class="n">MessageType</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- UMP Packet Type:   "</span> <span class="p">+</span> <span class="n">ump</span><span class="p">.</span><span class="n">PacketType</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- Message:           "</span> <span class="p">+</span> <span class="n">MidiMessageUtility</span><span class="p">.</span><span class="nf">GetMessageFriendlyNameFromFirstWord</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nf">PeekFirstWord</span><span class="p">()));</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">ump</span> <span class="k">is</span> <span class="n">MidiMessage32</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">ump32</span> <span class="p">=</span> <span class="n">ump</span> <span class="k">as</span> <span class="n">MidiMessage32</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ump32</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"- Word 0:            0x{0:X}"</span><span class="p">,</span> <span class="n">ump32</span><span class="p">.</span><span class="n">Word0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="c1">// wire up the event handler before opening the endpoint</span>
    <span class="n">receiveEndpoint</span><span class="p">.</span><span class="n">MessageReceived</span> <span class="p">+=</span> <span class="n">MessageReceivedHandler</span><span class="p">;</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Opening endpoint connection"</span><span class="p">);</span>

    <span class="n">receiveEndpoint</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
    <span class="n">sendEndpoint</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Creating MIDI 1.0 Channel Voice 32-bit UMP..."</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">ump32</span> <span class="p">=</span> <span class="n">MidiMessageBuilder</span><span class="p">.</span><span class="nf">BuildMidi1ChannelVoiceMessage</span><span class="p">(</span>
        <span class="n">MidiClock</span><span class="p">.</span><span class="n">Now</span><span class="p">,</span> <span class="c1">// use current timestamp</span>
        <span class="m">5</span><span class="p">,</span>      <span class="c1">// group 5</span>
        <span class="n">Midi1ChannelVoiceMessageStatus</span><span class="p">.</span><span class="n">NoteOn</span><span class="p">,</span>  <span class="c1">// 9</span>
        <span class="m">3</span><span class="p">,</span>      <span class="c1">// channel 3</span>
        <span class="m">120</span><span class="p">,</span>    <span class="c1">// note 120 - hex 0x78</span>
        <span class="m">100</span><span class="p">);</span>   <span class="c1">// velocity 100 hex 0x64</span>

    <span class="n">sendEndpoint</span><span class="p">.</span><span class="nf">SendMessagePacket</span><span class="p">((</span><span class="n">IMidiUniversalPacket</span><span class="p">)</span><span class="n">ump32</span><span class="p">);</span>  <span class="c1">// could also use the SendWords methods, etc.</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">" ** Wait for the message to arrive, and then press enter to cleanup. ** "</span><span class="p">);</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>

    <span class="c1">// you should unregister the event handler as well</span>
    <span class="n">receiveEndpoint</span><span class="p">.</span><span class="n">MessageReceived</span> <span class="p">-=</span> <span class="n">MessageReceivedHandler</span><span class="p">;</span>

    <span class="c1">// not strictly necessary if the session is going out of scope or is in a using block</span>
    <span class="n">session</span><span class="p">.</span><span class="nf">DisconnectEndpointConnection</span><span class="p">(</span><span class="n">sendEndpoint</span><span class="p">.</span><span class="n">ConnectionId</span><span class="p">);</span>
    <span class="n">session</span><span class="p">.</span><span class="nf">DisconnectEndpointConnection</span><span class="p">(</span><span class="n">receiveEndpoint</span><span class="p">.</span><span class="n">ConnectionId</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>